
    <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f9fb;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 40px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.08);
      padding: 30px;
      display: flex;
      gap: 30px;
    }
    h2 {
      text-align: center;
      color: #007bff;
      margin-bottom: 25px;
      width: 100%;
    }
    .slots-section {
      flex: 1 1 65%;
      min-width: 320px;
    }
    .bookings-section {
      flex: 1 1 35%;
      min-width: 280px;
      border-left: 1px solid #ddd;
      padding-left: 20px;
    }
    .add-btn {
      display: inline-block;
      margin-bottom: 18px;
      background: #28a745;
      color: #fff;
      padding: 10px 22px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 500;
      transition: background 0.2s;
    }
    .add-btn:hover {
      background: #218838;
    }
    .no-data {
      text-align: center;
      color: #999;
      padding: 30px 0;
      font-style: italic;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #e0e0e0;
      text-align: center;
      cursor: pointer;
    }
    th {
      background: #007bff;
      color: #fff;
    }
    tr:nth-child(even) {
      background: #f9f9f9;
    }
    tr.selected {
      background: #d0e9ff !important;
    }
    .btn-book {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 5px;
      color: #fff;
      text-decoration: none;
      margin: 0 5px 5px 0;
      font-size: 0.9em;
    }
    .no-booking {
      background: #dc3545;
    }
    .booked {
      background: #28a745;
    }
    .disabled {
      background: #ccc;
      pointer-events: none;
      cursor: not-allowed;
    }
    .booking-details {
      font-size: 0.95em;
      color: #444;
    }
    .booking-details h3 {
      color: #007bff;
      margin-bottom: 10px;
    }
    .booking-info {
      margin-bottom: 15px;
    }
    .booking-info strong {
      display: inline-block;
      width: 120px;
    }
    .no-bookings-text {
      font-style: italic;
      color: #999;
    }

    @media (max-width: 900px) {
      .container {
        flex-direction: column;
        padding: 15px;
      }
      .bookings-section {
        border-left: none;
        padding-left: 0;
        margin-top: 30px;
        min-width: 100%;
      }
      th, td {
        cursor: default;
      }
    }
    @media (max-width: 600px) {
      table {
        display: none;
      }
      .slots-section {
        width: 100%;
      }
    }
  </style>
{% extends 'workshopheader.html' %}
{% block content %}
<div class="container">
  <div class="slots-section">
    <h2>My Workshop Slots</h2>
    <a href="{% url 'add_workshop_slot' %}" class="add-btn">+ Add New Slot</a>

    {% if slots %}
    <table id="slotsTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Time</th>
          <th>Available</th>
          <th>Action</th>
          
        </tr>
      </thead>
      <tbody>
        {% for slot in slots %}
        <tr data-slot-id="{{ slot.id }}" data-date="{{ slot.date }}" data-time="{{ slot.time|time:'H:i' }}" data-available="{{ slot.is_available }}">
          <td>{{ slot.date }}</td>
          <td>{{ slot.time|time:"H:i" }}</td>
          <td>
            {% if slot.is_available %}
              <span class="btn-book no-booking">No Booking</span>
            {% else %}
              <span class="btn-book booked">Booked</span>
            {% endif %}
          </td>
          <td>
            {% if slot.is_available %}
              <a href="{% url 'delete_workshop_slot' slot.id %}" class="btn-book no-booking" onclick="return confirm('❗Are you sure you want to delete this slot?');">Delete</a>
            {% elif slot in paid_slot_ids %}
              <span class="btn-book disabled">Delete</span>
            {% else %}
              <a href="{% url 'delete_workshop_slot' slot.id %}" class="btn-book no-booking" onclick="return confirm('❗Are you sure you want to delete this slot?');">Delete</a>
            {% endif %}
          </td>
         
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
      <div class="no-data">No slots found.</div>
    {% endif %}
  </div>

  <div class="bookings-section">
    <h3>Booking Details</h3>
    <div id="bookingDetails" class="booking-details">
      <p class="no-bookings-text">Select a slot to see booking details here.</p>
    </div>
  </div>
</div>

<!-- 📦 Booking data from Django context -->
<script id="slot-bookings-data" type="application/json">
  {{ slot_bookings_json|safe }}
</script>

<script>
  const slotsTable = document.getElementById('slotsTable');
  const bookingDetails = document.getElementById('bookingDetails');
  const slotBookings = JSON.parse(document.getElementById('slot-bookings-data').textContent);

  if (slotsTable) {
    slotsTable.querySelectorAll('tbody tr').forEach(row => {
      row.addEventListener('click', () => {
        slotsTable.querySelectorAll('tbody tr').forEach(r => r.classList.remove('selected'));
        row.classList.add('selected');

        const slotId = row.getAttribute('data-slot-id');
        const date = row.getAttribute('data-date');
        const time = row.getAttribute('data-time');
        const available = row.getAttribute('data-available') === 'True';

        const bookings = slotBookings[slotId] || [];

        if (available || bookings.length === 0) {
          bookingDetails.innerHTML = `
            <p>No bookings for slot on <strong>${date}</strong> at <strong>${time}</strong>.</p>
          `;
        } else {
          let bookingList = bookings.map(b => `<li>${b.user} - ${b.status}</li>`).join('');
          bookingDetails.innerHTML = `
            <div class="booking-info">
              <strong>Date:</strong> ${date}<br>
              <strong>Time:</strong> ${time}
            </div>
            <div class="booking-info">
              <strong>Bookings:</strong>
              <ul>${bookingList}</ul>
            </div>
            <a href="{% url 'workshopappoinmentview' %}?slot=${slotId}" target="_blank" rel="noopener noreferrer" style="color:#007bff; font-weight:600;">View Full Booking Details</a>
          `;
        }
      });
    });
  }
</script>

<!-- </body>
</html> -->
{% endblock %}
